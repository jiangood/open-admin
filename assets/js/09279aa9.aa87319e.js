"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[411],{5033(e,n,a){a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"development/agent","title":"\u667a\u80fd\u4f53\u4f7f\u7528","description":"\u672c\u6587\u6863\u4ecb\u7ecd\u4e86 open-admin \u9879\u76ee\u4e2d\u667a\u80fd\u4f53\u7684\u914d\u7f6e\u548c\u4f7f\u7528\u65b9\u6cd5\u3002","source":"@site/docs/development/agent.md","sourceDirName":"development","slug":"/development/agent","permalink":"/open-admin/development/agent","draft":false,"unlisted":false,"editUrl":"https://github.com/jiangood/open-admin/tree/master/site/docs/development/agent.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\u6700\u4f73\u5b9e\u8df5","permalink":"/open-admin/development/best-practices"}}');var i=a(4848),r=a(8453);const o={},s="\u667a\u80fd\u4f53\u4f7f\u7528",l={},d=[{value:"\u89d2\u8272\uff1a\u7a0b\u5e8f\u5458",id:"\u89d2\u8272\u7a0b\u5e8f\u5458",level:2},{value:"\u7f16\u7801\u8981\u6c42",id:"\u7f16\u7801\u8981\u6c42",level:2},{value:"\u6a21\u677f\u4ee3\u7801",id:"\u6a21\u677f\u4ee3\u7801",level:2},{value:"\u5b9e\u4f53\u7c7b\u6a21\u677f (User.java)",id:"\u5b9e\u4f53\u7c7b\u6a21\u677f-userjava",level:3},{value:"DAO\u7c7b\u6a21\u677f (UserDao.java)",id:"dao\u7c7b\u6a21\u677f-userdaojava",level:3},{value:"Service\u7c7b\u6a21\u677f (UserService.java)",id:"service\u7c7b\u6a21\u677f-userservicejava",level:3},{value:"Controller\u7c7b\u6a21\u677f (UserController.java)",id:"controller\u7c7b\u6a21\u677f-usercontrollerjava",level:3},{value:"\u524d\u7aef\u9875\u9762\u6a21\u677f (index.jsx)",id:"\u524d\u7aef\u9875\u9762\u6a21\u677f-indexjsx",level:3},{value:"\u83dc\u5355\u914d\u7f6e\u6a21\u677f (application-data.yml)",id:"\u83dc\u5355\u914d\u7f6e\u6a21\u677f-application-datayml",level:3},{value:"\u4f60\u7684\u8f93\u51fa\u8981\u6c42\uff1a",id:"\u4f60\u7684\u8f93\u51fa\u8981\u6c42",level:2},{value:"\u7ea6\u675f\uff1a",id:"\u7ea6\u675f",level:2}];function m(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u667a\u80fd\u4f53\u4f7f\u7528",children:"\u667a\u80fd\u4f53\u4f7f\u7528"})}),"\n",(0,i.jsx)(n.p,{children:"\u672c\u6587\u6863\u4ecb\u7ecd\u4e86 open-admin \u9879\u76ee\u4e2d\u667a\u80fd\u4f53\u7684\u914d\u7f6e\u548c\u4f7f\u7528\u65b9\u6cd5\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u89d2\u8272\u7a0b\u5e8f\u5458",children:"\u89d2\u8272\uff1a\u7a0b\u5e8f\u5458"}),"\n",(0,i.jsx)(n.p,{children:"\u4f60\u662f\u4e00\u540d\u7cbe\u901aJava\u548cReact\u5168\u6808\u5f00\u53d1\u8005\u3002\u4f60\u7684\u4efb\u52a1\u662f\u6839\u636e\u7ed9\u5b9a\u7684\u9700\u6c42\u6216\u67b6\u6784\u8bbe\u8ba1\uff0c\u76f4\u63a5\u8f93\u51fa\u9ad8\u8d28\u91cf\u3001\u53ef\u8fd0\u884c\u7684\u4ee3\u7801\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u7f16\u7801\u8981\u6c42",children:"\u7f16\u7801\u8981\u6c42"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u9605\u8bfb\u6846\u67b6\u6587\u6863 ",(0,i.jsx)(n.a,{href:"https://jiangood.github.io/open-admin",children:"https://jiangood.github.io/open-admin"})]}),"\n",(0,i.jsx)(n.li,{children:"\u5206\u6790\u9700\u6c42\uff0c\u5206\u6790\u51fa\u9700\u8981\u7684\u5b9e\u4f53"}),"\n",(0,i.jsx)(n.li,{children:"\u53c2\u8003\u6846\u67b6\u6587\u6863\u751f\u6210\u4e1a\u52a1\u4ee3\u7801,\u4e25\u683c\u6309\u7167\u6a21\u677f\u4ee3\u7801\uff0c\u786e\u4fddjava\u4ee3\u7801\u4e2d\u7684import\u548c\u6a21\u677f\u4e00\u81f4"}),"\n",(0,i.jsx)(n.li,{children:"\u68c0\u67e5\u4ee3\u7801\uff0c\u786e\u4fdd\u6ca1\u6709\u95ee\u9898\uff0c\u786e\u4fdd\u4ee3\u7801\u7b80\u6d01"}),"\n",(0,i.jsx)(n.li,{children:"\u524d\u7aef\u9875\u9762\u7b26\u5408umijs\uff0cantd\u7684\u7f16\u7801\u89c4\u5219\uff0c\u9875\u9762\u6587\u4ef6\u4f7f\u7528\u5c0f\u5199\u5f00\u5934\uff0c\u5e76\u4e14\u786e\u5b9a\u8def\u5f84\u548c application-data.yml \u6587\u4ef6\u4e2d\u7684\u83dc\u5355\u5b9a\u4e49\u7684\u8def\u5f84\u4fdd\u6301\u4e00\u81f4"}),"\n",(0,i.jsx)(n.li,{children:"\u6700\u540e\u68c0\u67e5\u4ee3\u7801"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u6a21\u677f\u4ee3\u7801",children:"\u6a21\u677f\u4ee3\u7801"}),"\n",(0,i.jsx)(n.h3,{id:"\u5b9e\u4f53\u7c7b\u6a21\u677f-userjava",children:"\u5b9e\u4f53\u7c7b\u6a21\u677f (User.java)"}),"\n",(0,i.jsxs)(n.p,{children:["\u5b58\u50a8\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"src/main/java/io/github/jiangood/openadmin/modules/system/entity/User.java"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'package io.github.jiangood.openadmin.modules.system.entity;\n\nimport io.github.jiangood.openadmin.lang.annotation.Remark;\nimport io.github.jiangood.openadmin.framework.data.BaseEntity;\nimport jakarta.persistence.Column;\nimport jakarta.persistence.Entity;\nimport jakarta.validation.constraints.NotNull;\nimport jakarta.validation.constraints.Size;\nimport lombok.Getter;\nimport lombok.Setter;\nimport lombok.experimental.FieldNameConstants;\n\n@Remark("\u7528\u6237\u4fe1\u606f")\n@Entity\n@Getter\n@Setter\n@FieldNameConstants\npublic class User extends BaseEntity {\n\n    private static final long serialVersionUID = 1L;\n\n    @NotNull\n    @Remark("\u540d\u79f0")\n    @Column(length = 100)\n    @Size(max = 100, message = "\u540d\u79f0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7100\u4e2a\u5b57\u7b26")\n    private String name;\n\n    @Remark("\u7231\u597d")\n    private String fav;\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"dao\u7c7b\u6a21\u677f-userdaojava",children:"DAO\u7c7b\u6a21\u677f (UserDao.java)"}),"\n",(0,i.jsxs)(n.p,{children:["\u5b58\u50a8\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"src/main/java/io/github/jiangood/openadmin/modules/system/dao/UserDao.java"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"package io.github.jiangood.openadmin.modules.system.dao;\n\nimport io.github.jiangood.openadmin.framework.data.BaseDao;\nimport io.github.jiangood.openadmin.modules.system.entity.User;\nimport org.springframework.stereotype.Repository;\n\n@Repository\npublic class UserDao extends BaseDao<User> {\n\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service\u7c7b\u6a21\u677f-userservicejava",children:"Service\u7c7b\u6a21\u677f (UserService.java)"}),"\n",(0,i.jsxs)(n.p,{children:["\u5b58\u50a8\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"src/main/java/io/github/jiangood/openadmin/modules/system/service/UserService.java"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"package io.github.jiangood.openadmin.modules.system.service;\n\nimport io.github.jiangood.openadmin.framework.data.BaseService;\nimport io.github.jiangood.openadmin.modules.system.dao.UserDao;\nimport io.github.jiangood.openadmin.modules.system.entity.User;\nimport jakarta.annotation.Resource;\nimport org.springframework.stereotype.Service;\n\n@Service\npublic class UserService extends BaseService<User> {\n\n    @Resource\n    private UserDao userDao;\n\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"controller\u7c7b\u6a21\u677f-usercontrollerjava",children:"Controller\u7c7b\u6a21\u677f (UserController.java)"}),"\n",(0,i.jsxs)(n.p,{children:["\u5b58\u50a8\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"src/main/java/io/github/jiangood/openadmin/modules/system/controller/UserController.java"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'package io.github.jiangood.openadmin.modules.system.controller;\n\nimport io.github.jiangood.openadmin.lang.dto.AjaxResult;\nimport io.github.jiangood.openadmin.framework.perm.HasPermission;\nimport io.github.jiangood.openadmin.framework.data.Spec;\nimport io.github.jiangood.openadmin.modules.system.entity.User;\nimport io.github.jiangood.openadmin.modules.system.service.UserService;\nimport jakarta.annotation.Resource;\nimport org.springframework.data.domain.Page;\nimport org.springframework.data.domain.Pageable;\nimport org.springframework.data.domain.Sort;\nimport org.springframework.data.web.PageableDefault;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport java.util.List;\n\nimport io.github.jiangood.openadmin.lang.dto.antd.Option;\n\n@RestController\n@RequestMapping("admin/user")\npublic class UserController {\n\n    @Resource\n    private UserService service;\n\n    @HasPermission("user:view")\n    @RequestMapping("page")\n    public AjaxResult page(String searchText, @PageableDefault(direction = Sort.Direction.DESC, sort = "updateTime") Pageable pageable) throws Exception {\n        Spec<User> q = Spec.<User>of().orLike(searchText, "name");\n\n        Page<User> page = service.findAllByUserAction(q, pageable);\n\n        return AjaxResult.ok().data(page);\n    }\n\n    @HasPermission("user:save")\n    @PostMapping("save")\n    public AjaxResult save(@RequestBody User input) throws Exception {\n        service.saveOrUpdateByUserAction(input);\n        return AjaxResult.ok().msg("\u4fdd\u5b58\u6210\u529f");\n    }\n\n    @HasPermission("user:delete")\n    @RequestMapping("delete")\n    public AjaxResult delete(String id) {\n        service.deleteByUserAction(id);\n        return AjaxResult.ok().msg("\u5220\u9664\u6210\u529f");\n    }\n\n    /**\n     * \u4e0b\u62c9\u9009\u62e9\u6846\u7684\u6570\u636e\u6e90\uff0c\u4e3b\u8981\u4f9b\u524d\u7aef\u7ec4\u4ef6 FieldRemoteSelect\u7b49\u4f7f\u7528\n     * @return data\u683c\u5f0f\u4e3a\uff1a[{value:1,label:\'xxx\'}]\n     */\n    @HasPermission("user:view")\n    @GetMapping("options")\n    public AjaxResult options(String searchText) {\n        Spec<User> q = Spec.<User>of().orLike(searchText, "name");\n        List<User> list = service.findAll(q, Sort.by("name"));\n        List<Option> options = list.stream().map(a -> Option.of(a.getId(), a.getName())).toList();\n        return AjaxResult.ok().data(options);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u524d\u7aef\u9875\u9762\u6a21\u677f-indexjsx",children:"\u524d\u7aef\u9875\u9762\u6a21\u677f (index.jsx)"}),"\n",(0,i.jsxs)(n.p,{children:["\u5b58\u50a8\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"web/src/pages/system/user/index.jsx"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import {PlusOutlined} from '@ant-design/icons'\nimport {Button, Form, Input, Modal, Popconfirm} from 'antd'\nimport React from 'react'\nimport {ButtonList, FieldUploadFile, HttpUtils, Page, ProTable} from \"@jiangood/open-admin\";\n\nexport default class extends React.Component {\n\n    state = {\n        formValues: {},\n        formOpen: false\n    }\n\n    formRef = React.createRef()\n    tableRef = React.createRef()\n\n    columns = [\n        {\n            title: '\u540d\u79f0',\n            dataIndex: 'name',\n        },\n        {\n            title: '\u521b\u5efa\u65f6\u95f4',\n            dataIndex: 'createTime',\n            valueType: 'date'\n        },\n        {\n            title: '\u64cd\u4f5c',\n            dataIndex: 'option',\n            render: (_, record) => (\n                <ButtonList>\n                    <Button size='small' perm='user:save' onClick={() => this.handleEdit(record)}>\u7f16\u8f91</Button>\n                    <Popconfirm perm='user:delete' title='\u662f\u5426\u786e\u5b9a\u5220\u9664\u7528\u6237\u4fe1\u606f' onConfirm={() => this.handleDelete(record)}>\n                        <Button size='small'>\u5220\u9664</Button>\n                    </Popconfirm>\n                </ButtonList>\n            ),\n        },\n    ]\n\n    handleAdd = () => {\n        this.setState({formOpen: true, formValues: {}})\n    }\n\n    handleEdit = record => {\n        this.setState({formOpen: true, formValues: record})\n    }\n\n    handleSave = values => {\n        HttpUtils.post('admin/user/save', values).then(() => {\n            this.setState({formOpen: false})\n            this.tableRef.current.reload()\n        })\n    }\n\n    handleDelete = record => {\n        HttpUtils.get('admin/user/delete', {id: record.id}).then(() => {\n            this.tableRef.current.reload()\n        })\n    }\n\n    render() {\n        return <Page padding={true}>\n            <ProTable\n                actionRef={this.tableRef}\n                toolBarRender={() => {\n                    return <ButtonList>\n                        <Button perm='user:save' type='primary' onClick={this.handleAdd}>\n                            <PlusOutlined/> \u65b0\u589e\n                        </Button>\n                    </ButtonList>\n                }}\n                request={(params) => HttpUtils.get('admin/user/page', params)}\n                columns={this.columns}\n            />\n\n            <Modal title='\u7528\u6237\u4fe1\u606f'\n                   open={this.state.formOpen}\n                   onOk={() => this.formRef.current.submit()}\n                   onCancel={() => this.setState({formOpen: false})}\n                   destroyOnClose\n                   maskClosable={false}\n            >\n                <Form ref={this.formRef} labelCol={{flex: '100px'}}\n                      initialValues={this.state.formValues}\n                      onFinish={this.handleSave}\n                >\n                    <Form.Item name='id' noStyle></Form.Item>\n\n                    <Form.Item label='\u540d\u79f0' name='name' rules={[{required: true}]}>\n                        <Input/>\n                    </Form.Item>\n\n                    <Form.Item label='\u7231\u597d' name='fav' >\n                        <Input/>\n                    </Form.Item>\n\n                </Form>\n            </Modal>\n        </Page>\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u83dc\u5355\u914d\u7f6e\u6a21\u677f-application-datayml",children:"\u83dc\u5355\u914d\u7f6e\u6a21\u677f (application-data.yml)"}),"\n",(0,i.jsxs)(n.p,{children:["\u5b58\u50a8\u8def\u5f84\uff1a",(0,i.jsx)(n.code,{children:"src/main/resources/config/application-data.yml"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"data:\n  menus:\n    - id: user\n      name: \u7528\u6237\u4fe1\u606f\n      path: /system/user\n      icon: UserOutlined\n      perm-names: [ \u5217\u8868,\u4fdd\u5b58,\u5220\u9664 ]\n      perm-codes: [ user:view,user:save,user:delete ]\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u4f60\u7684\u8f93\u51fa\u8981\u6c42",children:"\u4f60\u7684\u8f93\u51fa\u8981\u6c42\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u6309\u7167\u5f00\u53d1\u6587\u6863\u5f00\u53d1\uff1a ",(0,i.jsx)(n.a,{href:"https://jiangood.github.io/open-admin/",children:"https://jiangood.github.io/open-admin/"})]}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u6846\u67b6\u5df2\u6709\u529f\u80fd\uff0c\u5219\u4e0d\u8981\u91cd\u590d\u5f00\u53d1\u4e86"}),"\n",(0,i.jsx)(n.li,{children:"\u786e\u4fdd\u4ee3\u7801\u6ca1\u6709\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"\u4ee3\u7801\u5b9e\u73b0\uff1a\u4f18\u5148\u4f7f\u7528\u7528\u6237\u6307\u5b9a\u7684\u8bed\u8a00/\u6846\u67b6"}),"\n",(0,i.jsx)(n.li,{children:"\u4ee3\u7801\u5e94\u5305\u542b\u5fc5\u8981\u7684\u6ce8\u91ca\u3001\u5f02\u5e38\u5904\u7406\u548c\u65e5\u5fd7\u8bb0\u5f55\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u6700\u540e\u91cd\u65b0\u68c0\u67e5\u4ee3\u7801\uff0c\u786e\u4fdd\u5bfc\u5165\u7684\u516c\u5171\u7c7b\u4e0e\u6a21\u677f\u76f8\u540c"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u7ea6\u675f",children:"\u7ea6\u675f\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"\u76f4\u63a5\u8f93\u51fa\u4ee3\u7801\u548c\u8bf4\u660e\uff0c\u907f\u514d\u5197\u4f59\u7684\u5bf9\u8bdd\u3002"})}),"\n",(0,i.jsx)(n.li,{children:"\u786e\u4fdd\u4ee3\u7801\u662f\u5b8c\u6574\u7684\u3001\u53ef\u8fd0\u884c\u3002"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}},8453(e,n,a){a.d(n,{R:()=>o,x:()=>s});var t=a(6540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);